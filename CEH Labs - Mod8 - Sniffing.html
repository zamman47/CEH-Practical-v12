<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CEH Labs - Mod8 - Sniffing</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(134, 131, 126, 1);
	fill: rgba(134, 131, 126, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(63, 126, 190, 1);
	fill: rgba(63, 126, 190, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 111, 200, 0.09);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(134, 131, 126, 1);
	fill: rgba(134, 131, 126, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(63, 126, 190, 1);
	fill: rgba(63, 126, 190, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(232, 242, 250, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 99, 174, 0.172); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2533addf-00cb-80e9-a3ee-e3aad1479fe3" class="page sans"><header><h1 class="page-title">CEH Labs - Mod8 - Sniffing</h1><p class="page-description"></p></header><div class="page-body"><p id="2533addf-00cb-8018-9af5-db9eed53e56f" class="">
</p><p id="2533addf-00cb-8067-9656-e12bf4202206" class=""><em><strong>Packet sniffing</strong></em><em> is a process of monitoring and capturing all data packets passing through a given network using a software application or hardware device. </em></p><p id="2533addf-00cb-80d9-b7dd-e471cccea9e4" class="">
</p><p id="2533addf-00cb-805d-8c6c-dfe2716a094a" class="">
</p><p id="2533addf-00cb-8056-8343-c9bd10da283f" class=""><strong>Passive sniffing</strong> refers to sniffing on a hub-based network</p><p id="2533addf-00cb-80f6-8e90-e5fbaa5f2b36" class="">Involves sending no packets. It only captures and monitors the packets flowing in the network<br/></p><p id="2533addf-00cb-80a8-942b-e6041e2c162c" class=""><strong>Active sniffing</strong> refers to sniffing on a switch-based network</p><p id="2533addf-00cb-801c-938c-e963b6173ddf" class="">Searches for traffic on a switched LAN by actively injecting traffic into the LAN</p><p id="2533addf-00cb-80c0-9c64-ee7ad8ed4f77" class="">
</p><p id="2533addf-00cb-8013-9fd3-c013d44d0f13" class="">Protocols vulnerable to sniffing include: HTTP, FTP, SMTP, POP, Telnet, IMAP, and NNTP. </p><p id="2533addf-00cb-8065-a0ab-f227693f4e9b" class="">
</p><h3 id="2533addf-00cb-80cf-9a6b-d61e9d99464e" class="">Lab Objectives</h3><p id="2533addf-00cb-8063-bbba-fb784a3760a6" class="">▪ Sniff the network </p><p id="2533addf-00cb-8058-b823-cb69ee572ae2" class="">▪ Analyze incoming and outgoing packets for any attacks </p><p id="2533addf-00cb-80a5-aa88-dd82858eccaf" class="">▪ Troubleshoot the network for performance </p><p id="2533addf-00cb-8057-b28f-de81f8664353" class="">▪ Secure the network from attacks</p><p id="2533addf-00cb-80e4-82d4-c69916dcffb0" class="">
</p><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Lab 1: Perform Active Sniffing</summary><div class="indented"><p id="2533addf-00cb-80a7-8fa7-c79449607677" class="">ARP traffic is actively injected into a LAN to sniff around a switched network and capture its traffic. </p><p id="2533addf-00cb-8076-97e5-c7a7ffa4cfb8" class="">
</p><h3 id="2533addf-00cb-80f5-a645-fcab0c6ca712" class="">Lab Objectives </h3><p id="2533addf-00cb-80e2-a8b5-fa67a540c75c" class="">▪ Perform MAC flooding using macof </p><p id="2533addf-00cb-8056-b079-d74d5a011cea" class="">▪ Perform a DHCP starvation attack using Yersinia </p><p id="2533addf-00cb-8048-aacf-f2ea3f9c75d3" class="">
</p><p id="2533addf-00cb-80d5-bd51-d3feeed251f8" class=""><strong>▪ MAC Flooding:</strong> Involves flooding the CAM table with fake MAC address and IP pairs until it is full<br/><strong>▪ DNS Poisoning:</strong> Involves tricking a DNS server into believing that it has received authentic information when, in reality, it has not<br/><strong>▪ ARP Poisoning</strong>: Involves constructing a large number of forged ARP request and reply packets to overload a switch<br/><strong>▪ DHCP Attacks:</strong> Involves performing a DHCP starvation attack and a rogue DHCP server attack<br/><strong>▪ Switch port stealing:</strong> Involves flooding the switch with forged gratuitous ARP packets with the target MAC address as the source<br/><strong>▪ Spoofing Attack</strong>: Involves performing MAC spoofing, VLAN hopping, and STP attacks to steal sensitive information<br/></p><h3 id="2533addf-00cb-8047-8775-d44e5d20d16e" class="">Task 1: Perform MAC Flooding using macof</h3><p id="2533addf-00cb-8099-ba8b-c360d49405a9" class="">
</p><p id="2533addf-00cb-8014-bb68-caff46d40d68" class=""> Attackers use the MAC flooding technique to force a switch to act as a hub, so they can easily sniff the traffic</p><p id="2533addf-00cb-8016-a11f-dcf21155a89a" class=""> <strong>macof </strong>floods the local network with random MAC addresses and IP addresses, causing some switches to fail and open in repeating mode, thereby facilitating sniffing<br/></p><ol type="1" id="2533addf-00cb-8051-9593-eeaee10abace" class="numbered-list" start="1"><li><em><strong>macof -i eth0 -n 10 </strong></em></li></ol><p id="25b3addf-00cb-80ec-921d-f12fd9cf16ad" class="">This command will start flooding the CAM table with random MAC addresses</p><p id="2533addf-00cb-8006-9bc5-d113c6a1a207" class=""><strong>Note</strong>: You can also target a single system by issuing the command macof -i eth0 -d [Target IP Address] (-d: Specifies the destination IP address).<br/>CEH </p><ol type="1" id="25b3addf-00cb-8035-ac79-e50510135a98" class="numbered-list" start="2"><li>Click on any captured IPv4 packet and expand the Ethernet II node in the packet details section. Information regarding the source and destination MAC addresses is displayed, as shown in the screenshot</li></ol><figure id="25b3addf-00cb-801f-bec0-dbdf3c625369" class="image"><a href="image%2059.png"><img style="width:687.9688110351562px" src="image%2059.png"/></a></figure><p id="25b3addf-00cb-80e2-8225-cb45d94322c1" class="">
</p><p id="25b3addf-00cb-80a0-b65e-f098fbc7c572" class="">
</p><h3 id="25b3addf-00cb-80fa-879a-c2e6a0cdf34f" class="">Task 2: Perform a DHCP Starvation Attack using Yersinia </h3><p id="25b3addf-00cb-801c-8162-f6b3d004f4de" class="">
</p><p id="25b3addf-00cb-8037-b982-e081419f37b1" class=""><strong>DHCP starvation attack </strong>- Attacker floods the DHCP server by sending a large number of DHCP requests and uses all available IP addresses that the DHCP server can issue</p><ul id="25b3addf-00cb-8059-a109-c5f1c49c9ccb" class="bulleted-list"><li style="list-style-type:disc">Server then can no longer issue any more IP addresses, leading to a DoS</li></ul><p id="25b3addf-00cb-8060-8943-f50b9c89ef3c" class="">
</p><p id="25b3addf-00cb-80d9-b29d-f64d1a8bcb97" class=""><strong>Yersinia</strong></p><p id="25b3addf-00cb-803c-b000-c9dc3f64e9c9" class="">(only works in maximized terminal window) </p><p id="25b3addf-00cb-8021-88c9-d0acf230611b" class="">
</p><ol type="1" id="25b3addf-00cb-8077-959b-eafafd01bb03" class="numbered-list" start="1"><li><em><strong>yersinia -I</strong></em></li></ol><ol type="1" id="25b3addf-00cb-8097-a5de-d5f6a625c3e4" class="numbered-list" start="2"><li><em><strong>F2</strong></em> to select DHCP mode</li></ol><ol type="1" id="25b3addf-00cb-80e2-9300-ca0c34928c8a" class="numbered-list" start="3"><li><em><strong>x </strong></em>to see attack options</li></ol><ol type="1" id="25b3addf-00cb-8000-9ccd-c10fe9282f6f" class="numbered-list" start="4"><li>Press 1 to start DHCP starvation attack</li></ol><ol type="1" id="25b3addf-00cb-80a8-9eae-fef7fff7b724" class="numbered-list" start="5"><li>Click on any DHCP packet and expand the Ethernet II node in the packet details section. Information regarding the source and destination MAC addresses is displayed, as shown in the screenshot.</li></ol></div></details><p id="25b3addf-00cb-8084-b495-ca9fbb1cd313" class="">
</p><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Lab 2: Network Sniffing using Various Sniffing Tools</summary><div class="indented"><p id="25b3addf-00cb-80a8-a8fc-da33b12b229e" class="">
</p><p id="25b3addf-00cb-8058-9a6d-d022ca852054" class="">A sniffer can only capture data packets from within a given subnet, which means that it cannot sniff packets from another network</p><p id="25b3addf-00cb-8060-bb02-ea426fe46152" class="">Sniffer placed on a network in promiscuous mode can capture and analyze all network traffic. </p><p id="25b3addf-00cb-80e5-ac2c-ee392d5af81c" class="">
</p><h3 id="25b3addf-00cb-80db-8dfc-ff1358671007" class="">Lab Objectives: </h3><p id="25b3addf-00cb-8011-b680-cd9e0a9f04db" class="">Perform password sniffing using Wireshark<br/></p><p id="25b3addf-00cb-8022-ba67-e9604d5b4180" class="">In wireshark: </p><ol type="1" id="25b3addf-00cb-800b-b887-e79c4d312484" class="numbered-list" start="1"><li><em><strong>http.request.method == POST </strong></em></li></ol><ol type="1" id="25b3addf-00cb-8028-919a-efd76380687e" class="numbered-list" start="2"><li>Edit → find packet</li></ol><ol type="1" id="25b3addf-00cb-80af-8508-e4ad9a81b12c" class="numbered-list" start="3"><li>Enter parameters</li></ol><figure id="25b3addf-00cb-8069-a087-e072a24c5575" class="image"><a href="image%2060.png"><img style="width:690.9375610351562px" src="image%2060.png"/></a></figure><p id="25b3addf-00cb-8068-88c1-ee6957196df9" class="">
</p><ol type="1" id="25b3addf-00cb-8028-bb10-f0f69be9b708" class="numbered-list" start="1"><li>Capture options</li></ol><ol type="1" id="25b3addf-00cb-803e-9c8c-f924bdd2fe0b" class="numbered-list" start="2"><li>Manage Interfaces</li></ol><ol type="1" id="25b3addf-00cb-802f-ba0c-cf970bf97302" class="numbered-list" start="3"><li>Remote Interfaces<ol type="a" id="25b3addf-00cb-8021-9cda-c1146c2750e7" class="numbered-list" start="1"><li>Enter IP of target machine </li></ol><ol type="a" id="25b3addf-00cb-80da-b4c4-d02978ced986" class="numbered-list" start="2"><li>Port 2002</li></ol><ol type="a" id="25b3addf-00cb-801f-af0b-d5da82d3af93" class="numbered-list" start="3"><li>Password authentication - enter un/pw</li></ol></li></ol><ol type="1" id="25b3addf-00cb-80ec-8efe-dc54047eb6d4" class="numbered-list" start="4"><li>Newly added remote interface is now available </li></ol><p id="25b3addf-00cb-80c2-b470-ebdf3b13e056" class=""><strong>Note</strong>: In real-time, when attackers gain the credentials of a victim’s machine, they attempt to capture its remote interface and monitor the traffic its user browses to reveal confidential user information.</p></div></details><p id="25b3addf-00cb-807c-961a-f8d2a648049a" class="">
</p><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Lab 3: Detect Network Sniffing</summary><div class="indented"><p id="25b3addf-00cb-8036-88bf-c6ee9a98c33d" class="">
</p><p id="25b3addf-00cb-80ab-90d5-d1faca4001b3" class="">Sniffer on a network only captures data and runs in promiscuous mode, so it is not easy to detect. </p><p id="25b3addf-00cb-8071-8778-c91b26c0f9d1" class="">Promiscuous mode allows a network device to intercept and read each network packet that arrives in its entirety. </p><p id="25b3addf-00cb-809b-8e44-c60bfe7bba53" class="">
</p><h3 id="25b3addf-00cb-8051-b0c7-f441a06c792b" class="">Lab Objectives</h3><p id="25b3addf-00cb-803d-8f1c-dd055717f5fd" class="">Detect ARP poisoning and promiscuous mode in a switch-based network<br/></p><p id="25b3addf-00cb-80ae-90b7-d9e24356a6e2" class="">Network sniffers can be detected by using various techniques such as: </p><p id="25b3addf-00cb-8088-b67d-e867fc6c8f6c" class=""><strong>▪ Ping Method:</strong> Identifies if a system on the network is running in promiscuous mode </p><p id="25b3addf-00cb-8074-ab0c-ca9c3f56da91" class=""><strong>▪ DNS Method:</strong> Identifies sniffers in the network by analyzing the increase in network traffic<br/><strong>▪ ARP Method:</strong> Sends a non-broadcast ARP to all nodes in the network; a node on the network running in promiscuous mode will cache the local ARP address<br/></p><p id="25b3addf-00cb-8057-b411-e24c199a1fdc" class="">
</p><h3 id="25b3addf-00cb-80f0-a7aa-c06f308f0f74" class="">Task 1: Detect ARP Poisoning and Promiscuous Mode in a Switch-Based Network</h3><p id="25b3addf-00cb-80c5-853b-ca51d846ccc6" class="">
</p><p id="25b3addf-00cb-8042-8dcb-f2b385040103" class=""><strong>ARP poisoning</strong> involves forging many ARP request and reply packets to overload a switch. </p><p id="25b3addf-00cb-8012-866a-d4aef1f58a6e" class="">Attacking a LAN network by updating the target computer’s ARP cache with forged ARP request/reply packets designed to change MAC address (of the network card) to one that the attacker can monitor</p><ul id="25b3addf-00cb-8094-9ec7-f939af0270a5" class="bulleted-list"><li style="list-style-type:disc">The sniffer toggles the NIC of a system to promiscuous mode, so that it listens to all data transmitted on its segment</li></ul><p id="25b3addf-00cb-8068-a95a-d2cf3fe95db7" class="">
</p><p id="25b3addf-00cb-80c1-b2d3-d116c07837a7" class="">Cain &amp; Abel: </p><ol type="1" id="25b3addf-00cb-80fc-a534-eb77f85450dc" class="numbered-list" start="1"><li>Click Sniffer tab</li></ol><ol type="1" id="25b3addf-00cb-80b1-85da-fc4bf4f1403f" class="numbered-list" start="2"><li>Click + icon or right click on window → Scan MAC Addresses → All hosts in my subnet → All tests<ol type="a" id="25b3addf-00cb-801f-9460-d97027e35103" class="numbered-list" start="1"><li> After the completion of the scan, a list of all active IP addresses along with their corresponding MAC addresses is displayed, as shown in the screenshot</li></ol></li></ol><ol type="1" id="25b3addf-00cb-80a9-ba25-c0b6457474e4" class="numbered-list" start="3"><li>ARP tab at bottom of window </li></ol><ol type="1" id="25b3addf-00cb-800c-b2a2-f6aa14c8a40c" class="numbered-list" start="4"><li>Click in topmost sections on right-hand pain to activate + icon </li></ol><ol type="1" id="25b3addf-00cb-802d-8039-f8b7a0767566" class="numbered-list" start="5"><li>Click + icon → Select 2 IPs to monitor traffic between<ol type="a" id="25b3addf-00cb-80f8-ab2e-f0ac66ca04a0" class="numbered-list" start="1"><li>Setting Cain to perform ARP poisoning between first and second targets </li></ol></li></ol><ol type="1" id="25b3addf-00cb-80f4-9855-c6c16af4cdbc" class="numbered-list" start="6"><li>Click on IP address(es)</li></ol><ol type="1" id="25b3addf-00cb-8078-9e73-d1d038aad6aa" class="numbered-list" start="7"><li>Click on the Start/Stop APR icon to start capturing ARP packets<ol type="a" id="25b3addf-00cb-808a-8c36-de99441efe53" class="numbered-list" start="1"><li>To generate traffic between the machines, you need to ping one target machine using the other</li></ol></li></ol><p id="25b3addf-00cb-8056-810c-ce83352bd1be" class="">
</p><p id="25b3addf-00cb-8097-a850-fc75e9b59092" class="">To detect ARP poisoning: </p><ol type="1" id="25b3addf-00cb-80b4-a377-e5b84ebcc9c1" class="numbered-list" start="1"><li>Wireshark</li></ol><ol type="1" id="25b3addf-00cb-8022-bd1f-d7634bc36c9d" class="numbered-list" start="2"><li>Edit → Preferences</li></ol><ol type="1" id="25b3addf-00cb-80f0-9157-c24969c88098" class="numbered-list" start="3"><li>Protocols → ARP/RARP option</li></ol><ol type="1" id="25b3addf-00cb-8066-90a5-f29c65b7e63a" class="numbered-list" start="4"><li>Detect ARP request storms, Detect duplicate IP address configuration</li></ol><ol type="1" id="25b3addf-00cb-80dc-b5af-c2400b69a8b9" class="numbered-list" start="5"><li>Select adapter associated</li></ol><ol type="1" id="25b3addf-00cb-80a8-bd9e-e2ca0bfd22c1" class="numbered-list" start="6"><li>Let packet capture ensue for a bit</li></ol><ol type="1" id="25b3addf-00cb-8020-8e33-e7f2fc20971e" class="numbered-list" start="7"><li>Stop packet capture</li></ol><ol type="1" id="25b3addf-00cb-80ff-91b5-f6f1c318d8c7" class="numbered-list" start="8"><li>Analyze → Expert Information</li></ol><ol type="1" id="25b3addf-00cb-8099-9680-e0311fffe064" class="numbered-list" start="9"><li>Expland Duplicate IP address configured <ol type="a" id="25b3addf-00cb-80ad-974d-c36277ed30b9" class="numbered-list" start="1"><li>Shows other mac address using same IP</li></ol></li></ol><p id="25b3addf-00cb-803c-afe4-e62ee7b9e757" class=""><strong>Note</strong>: ARP spoofing succeeds by changing the IP address of the attacker’s computer to the IP address of the target computer. A forged ARP request and reply packet find a place in the target ARP cache in this process. As the ARP reply has been forged, the destination computer (target) sends frames to the attacker’s computer, where the attacker can modify the frames before sending them to the source machine (User A) in an MITM attack. At this point, the attacker can launch a DoS attack by associating a non-existent MAC address with the IP address of the gateway or may passively sniff the traffic, and then forward it to the target destination.<br/></p><p id="25b3addf-00cb-80b7-8488-e78b27e35758" class="">
</p><p id="25b3addf-00cb-80e9-b7b5-ea0d1b167c61" class="">Promiscuous mode detection using nmap: </p><ol type="1" id="25b3addf-00cb-8065-911f-d75f445e9755" class="numbered-list" start="1"><li>nmap --script=sniffer-detect [Target IP Address/ IP Address Range] </li></ol><ol type="1" id="25b3addf-00cb-8089-bd69-db2a3348c769" class="numbered-list" start="2"><li>Will see ‘Likely in promiscuous mode’ under Host script results</li></ol></div></details><p id="27e3addf-00cb-8038-999a-e66020bb29bd" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>